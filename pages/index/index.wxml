<wxs module="filter" src="../../utils/filter.wxs"></wxs>
<view class="container">
    <view class="saveImg" wx:if="{{showSave}}" class="saveBtns" catch:tap="saveImg">
        <view class="text">保存到本地</view>
    </view>
    <poster id="poster" config="{{posterConfig}}" wx:if="{{showSave}}" bind:success="onPosterSuccess" bind:fail="onPosterFail"></poster>
    <!-- 分享区域 -->
    <view class="shareBox" wx:if="{{shareFlag}}">
        <view class="topBox">
            <view class="imgS">
                <button open-type="share" class="weixinBox">
                    <view class="img">
                        <image src="../../dist/icon/weixin.png" style="width:80rpx;height:80rpx" />
                    </view>
                    <view>分享好友</view>
                </button>
            </view>
            <view class="imgS" bind:tap="onCreatePoster" bind:fail="onPosterFail">
                <view class="img">
                    <image src="../../dist/icon/haibao.png" style="width:80rpx;height:80rpx" />
                </view>
                <view>生成海报</view>
            </view>
        </view>
        <view class="cancel" catch:tap="cancelShare">取消</view>
    </view>
    <!-- 定位信息 -->
    <view class="titleBox">
        <view class="post" catch:tap="switchDot" wx:if="{{postInfo}}">
            <view class="tuanImg">
                <van-image width="40" height="40" src="{{imgAddress+postInfo.avatar}}" round />
            </view>
            <view class="tuanInfo">
                <view class="titleName">{{postInfo.user_true_name}}</view>
                <view class="titleDesc defaultColor descSize">{{postInfo.user_address}}</view>
            </view>
        </view>
        <view class="postE" catch:tap="switchDot" wx:else>
            <view>选择团长</view>
        </view>
        <view class="shareInfo">
            <view class="share defaultColor descSize" catch:tap="shareBtn">
                <view>
                    <image style="width:44rpx;height:44rpx" src="../../dist/icon/share.png" />
                </view>
                <view>分享</view>
            </view>
        </view>
    </view>
    <!-- loop -->
    <view class="loop">
        <swiper indicator-dots="{{indicatorDots}}" autoplay="{{autoplay}}" interval="{{interval}}" duration="{{duration}}">
            <block wx:for="{{imgUrls}}" wx:key="index" wx:for-item="item">
                <swiper-item>
                    <view class="swiper-item">
                        <image src="{{imgAddress+item.url}}" mode="aspectFit top"/>
                    </view>
                </swiper-item>
            </block>
        </swiper>
    </view>
    <!-- tab -->
    <view>
        <scroll-view scroll-x="true" id="tab">
            <block wx:for="{{activeArea}}" wx:key="index">
                <view wx:for-item="item" wx:key="index" class="viewName {{active==item.id?'activeTab':''}}" catch:tap="activeTap" data-cateId="{{item.id}}">
                    {{item.name}}
                </view>
            </block>
        </scroll-view>
        <view class="goodList" wx:for="{{activeList}}" wx:for-item="item" wx:for-index="index" wx:key="index">
            <view class="goodS" catch:tap="detailtap" data-goodId="{{item.id}}">
                <view class="good">
                    <image style="width:100%" mode="widthFix" src="{{imgAddress+item.goods_img}}"></image>
                </view>
                <view class="goodName">{{item.goods_name}}</view>
                <view class="goodCon">
                    <view class="desc">
                        <view class="time">预售时间:{{todayDate}}</view>
                        <view class="descCon defaultColor descSize">
                            已售{{item.goods_volume_false}}{{item.goods_spec}}
                        </view>
                    </view>
                    <view class="desc">
                        <view class="time">提货时间:{{tomorrowDate}}</view>
                        <view class="descCon defaultColor descSize">
                            限量{{item.limit_num}}{{item.goods_spec}}
                        </view>
                    </view>
                </view>
                <view class="goodBottom">
                    <view class="priceBox">
                        <view>¥</view>
                        <view class="price">{{item.present_price}}</view>
                        <view class="orPrice defaultColor middleLine">
                            ¥{{item.original_price}}
                        </view>
                    </view>
                    <view class="addBtn">
                        <van-button round size="small" type="danger" custom-class="add" catch:tap="addCart" data-goodId="{{item.id}}" wx:if="{{!filter.countEnd(item.pt_start_time,item.pt_houres)}}">
                            加入购物车
                        </van-button>
                    </view>
                </view>
            </view>
        </view>
    </view>
</view>